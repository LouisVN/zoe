<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="Zoe - The Kafka companion"><meta name="author" content="Adevinta"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="../../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.3.1"><title>Prepare the environment - Zoe - The Kafka Companion</title><link rel="stylesheet" href="../../assets/stylesheets/application.4031d38b.css"><link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css"><meta name="theme-color" content="#7e57c2"><script src="../../assets/javascripts/modernizr.74668098.js"></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=swap"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel="stylesheet" href="../../assets/fonts/material-icons.css"></head><body dir="ltr" data-md-color-primary="deep-purple" data-md-color-accent="indigo"><svg class="md-svg"><defs><svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#prepare-the-environment" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href="../.." title="Zoe - The Kafka Companion" class="md-header-nav__button md-logo"><i class="md-icon"></i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">Zoe - The Kafka Companion</span><span class="md-header-nav__topic">Prepare the environment</span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">Type to start searching</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div><div class="md-flex__cell md-flex__cell--shrink"><div class="md-header-nav__source"><a href="https://github.com/adevinta/zoe/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">adevinta/zoe</div></a></div></div></div></nav></header><div class="md-container"><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href="../.." title="Zoe - The Kafka Companion" class="md-nav__button md-logo"><i class="md-icon"></i></a>Zoe - The Kafka Companion</label><div class="md-nav__source"><a href="https://github.com/adevinta/zoe/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">adevinta/zoe</div></a></div><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../.." title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2"><label class="md-nav__link" for="nav-2">Install</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-2">Install</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../install/overview/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="../../install/package/" title="Platform packages" class="md-nav__link">Platform packages</a></li><li class="md-nav__item"><a href="../../install/tarball/" title="Tarball install" class="md-nav__link">Tarball install</a></li><li class="md-nav__item"><a href="../../install/docker/" title="Docker" class="md-nav__link">Docker</a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked><label class="md-nav__link" for="nav-3">Getting started</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-3">Getting started</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../overview/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><label class="md-nav__link md-nav__link--active" for="__toc">Prepare the environment</label><a href="./" title="Prepare the environment" class="md-nav__link md-nav__link--active">Prepare the environment</a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#prerequisites" title="Prerequisites" class="md-nav__link">Prerequisites</a></li><li class="md-nav__item"><a href="#spin-up-the-kafka-cluster" title="Spin up the Kafka cluster" class="md-nav__link">Spin up the Kafka cluster</a></li><li class="md-nav__item"><a href="#configuring-zoe" title="Configuring zoe" class="md-nav__link">Configuring zoe</a></li></ul></nav></li><li class="md-nav__item"><a href="../produce/" title="Producing data" class="md-nav__link">Producing data</a></li><li class="md-nav__item"><a href="../consume/" title="Consuming data" class="md-nav__link">Consuming data</a></li><li class="md-nav__item"><a href="../operations/" title="Operations" class="md-nav__link">Operations</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4"><label class="md-nav__link" for="nav-4">Configuration</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-4">Configuration</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../configuration/overview/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="../../configuration/init/" title="Config initialization" class="md-nav__link">Config initialization</a></li><li class="md-nav__item"><a href="../../configuration/environments/" title="Environments" class="md-nav__link">Environments</a></li><li class="md-nav__item"><a href="../../configuration/chain/" title="Configuration loading chain" class="md-nav__link">Configuration loading chain</a></li><li class="md-nav__item"><a href="../../configuration/reference/" title="Reference" class="md-nav__link">Reference</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5"><label class="md-nav__link" for="nav-5">Advanced usage</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-5">Advanced usage</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../advanced/avro/" title="Using avro and schema registry" class="md-nav__link">Using avro and schema registry</a></li><li class="md-nav__item"><a href="../../advanced/expressions/" title="Registered expressions" class="md-nav__link">Registered expressions</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-3" type="checkbox" id="nav-5-3"><label class="md-nav__link" for="nav-5-3">Secrets provider</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-3">Secrets provider</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../advanced/secrets/overview/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="../../advanced/secrets/envvars/" title="Environment variables provider" class="md-nav__link">Environment variables provider</a></li><li class="md-nav__item"><a href="../../advanced/secrets/strongbox/" title="Strongbox provider" class="md-nav__link">Strongbox provider</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4" type="checkbox" id="nav-5-4"><label class="md-nav__link" for="nav-5-4">Runners in depth</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-4">Runners in depth</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../advanced/runners/overview/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="../../advanced/runners/local/" title="Local" class="md-nav__link">Local</a></li><li class="md-nav__item"><a href="../../advanced/runners/lambda/" title="Lambda" class="md-nav__link">Lambda</a></li><li class="md-nav__item"><a href="../../advanced/runners/kubernetes/" title="Kubernetes" class="md-nav__link">Kubernetes</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6"><label class="md-nav__link" for="nav-6">Tutorials</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-6">Tutorials</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../tutorials/overview/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="../../tutorials/simple/" title="Simple" class="md-nav__link">Simple</a></li><li class="md-nav__item"><a href="../../tutorials/avro/" title="Zoe with Avro" class="md-nav__link">Zoe with Avro</a></li><li class="md-nav__item"><a href="../../tutorials/kubernetes/" title="Zoe with Kubernetes" class="md-nav__link">Zoe with Kubernetes</a></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#prerequisites" title="Prerequisites" class="md-nav__link">Prerequisites</a></li><li class="md-nav__item"><a href="#spin-up-the-kafka-cluster" title="Spin up the Kafka cluster" class="md-nav__link">Spin up the Kafka cluster</a></li><li class="md-nav__item"><a href="#configuring-zoe" title="Configuring zoe" class="md-nav__link">Configuring zoe</a></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><a href="https://github.com/adevinta/zoe/edit/master/docs/basics/prepare.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a><h1 id="prepare-the-environment">Prepare the environment</h1>
<p>In this step, we will spin up a single node kafka cluster with docker and docker compose. This cluster will be initialized with some topics created by an initializer script.</p>
<p>We will then create the required zoe configuration to point to this cluster so we can start interacting with it.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>For this tutorial you will need :</p>
<ul>
<li>Zoe (follow the install instructions <a href="../../install/overview/">here</a>)</li>
<li>Docker and docker-compose</li>
</ul>
<h2 id="spin-up-the-kafka-cluster">Spin up the Kafka cluster</h2>
<p>Clone the <a href="https://github.com/adevinta/zoe">zoe repository</a> and use the provided compose file to spin up the kafka cluster :</p>
<div class="codehilite"><pre><span></span><span class="c1"># clone the repo</span>
git clone https://github.com/adevinta/zoe.git

<span class="c1"># go the to the tutorials folder</span>
<span class="nb">cd</span> zoe/tutorials/simple

<span class="c1"># spin up the stack</span>
docker-compose up -d
</pre></div>

<p>Now you should have :</p>
<ul>
<li>A zookeeper node</li>
<li>A kafka node</li>
<li>2 topics created : <code>input-topic</code> and <code>another-topic</code></li>
</ul>
<p>Now let's go to the next step and configure zoe to point to this cluster.</p>
<h2 id="configuring-zoe">Configuring zoe</h2>
<p>Zoe uses a central configuration file to store all the information related to the kafka clusters we may interact with. This file keeps all the cluster properties (<code>bootstrap.servers</code>, etc.) and topics configuration so we don't have to repeat them again and again each time we want to interact with the cluster.</p>
<p>We can easily initialize a default configuration file using :</p>
<div class="superfences-tabs">
<input name="__tabs_1" type="radio" id="__tab_1_0" checked="checked" />
<label for="__tab_1_0">command</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>zoe -v config init
</pre></div></div>
<input name="__tabs_1" type="radio" id="__tab_1_1" />
<label for="__tab_1_1">logs</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>2020-03-07 01:43:16 INFO zoe: creating a new config file...
</pre></div></div>
</div>
<p>This creates a default configuration file at <code>~/.zoe/config/default.yml</code> that can be used as a starting point. The file looks like the following (some optional fields have been omitted for readability):</p>
<div class="codehilite"><pre><span></span><span class="nt">clusters</span><span class="p">:</span>

  <span class="nt">local</span><span class="p">:</span>
    <span class="nt">props</span><span class="p">:</span>
      <span class="nt">bootstrap.servers</span><span class="p">:</span> <span class="s">&quot;localhost:29092&quot;</span>
      <span class="nt">key.deserializer</span><span class="p">:</span> <span class="s">&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span>
      <span class="nt">value.deserializer</span><span class="p">:</span> <span class="s">&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span>
      <span class="nt">key.serializer</span><span class="p">:</span> <span class="s">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>
      <span class="nt">value.serializer</span><span class="p">:</span> <span class="s">&quot;org.apache.kafka.common.serialization.ByteArraySerializer&quot;</span>

<span class="nt">runners</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span> <span class="s">&quot;local&quot;</span>
</pre></div>

<p>This config file defines the following elements :</p>
<ul>
<li>A <code>clusters</code> section where all the kafka clusters configuration are defined. Each cluster configuration is keyed by an alias. In the configuration above, a single kafka cluster configuration aliased by <code>local</code> is defined in the above config. This alias is what we will use to refer to this cluster when using <code>zoe --cluster local</code>. Each cluster configuration defines:<ul>
<li>A <code>props</code> section that represent the set of properties to be injected to the kafka clients when interacting with the cluster.</li>
<li>A <code>topics</code> section that contain a list of topic configuration keyed by an alias. In the configuration above, one topic configuration is defined with the alias <code>input</code>. A topic configuration contains the real name of the topic (in this case <code>input-topic</code>) and optionally a subject name if the topic is an avro topic. This alias is what we will use to refer to the topic when targeting it for writing or reading in zoe. This relieves us from the difficulty of dealing with and remembering long topic names.</li>
</ul>
</li>
<li>Lastly, there is a <code>runners</code> section that defines the <code>local</code> runner as the default. We will talk more about runners in <a href="../../advanced/runners/overview/">the advanced section</a> of this documentation but keep in mind that zoe offloads the consumption and the interaction with kafka clusters to "runners" that can either be local or remote (lambda functions or kubernetes pods).</li>
</ul>
<p>The default generated configuration is already enough to interact with our locally spinned up kafka cluster. We should be able to start interacting with it without any change.</p>
<p>Let's use zoe to list the available topics :</p>
<div class="superfences-tabs">
<input name="__tabs_2" type="radio" id="__tab_2_0" checked="checked" />
<label for="__tab_2_0">command</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>zoe --cluster <span class="nb">local</span> topics list
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_1" />
<label for="__tab_2_1">output</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="p">[</span><span class="s2">&quot;input-topic&quot;</span><span class="p">,</span> <span class="s2">&quot;another-topic&quot;</span><span class="p">]</span>
</pre></div></div>
</div>
<p>We can see that there is 2 topics within our cluster. To avoid having to remember their names, let's add them in the configuration and give them a friendly alias:</p>
<div class="codehilite"><pre><span></span><span class="nt">clusters</span><span class="p">:</span>

  <span class="nt">local</span><span class="p">:</span>
    <span class="nt">props</span><span class="p">:</span>
      <span class="nt">bootstrap.servers</span><span class="p">:</span> <span class="s">&quot;localhost:29092&quot;</span>
      <span class="nt">key.deserializer</span><span class="p">:</span> <span class="s">&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span>
      <span class="nt">value.deserializer</span><span class="p">:</span> <span class="s">&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span>
      <span class="nt">key.serializer</span><span class="p">:</span> <span class="s">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>
      <span class="nt">value.serializer</span><span class="p">:</span> <span class="s">&quot;org.apache.kafka.common.serialization.ByteArraySerializer&quot;</span>
    <span class="nt">topics</span><span class="p">:</span>
      <span class="nt">input</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;input-topic&quot;</span>
      <span class="nt">another</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;another-topic&quot;</span>

<span class="nt">runners</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span> <span class="s">&quot;local&quot;</span>
</pre></div>

<p>Now that our configuration is ready, let's use zoe to <a href="../produce/">produce some test data into the cluster</a>.</p></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a href="../overview/" title="Overview" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Previous</span>Overview</span></div></a><a href="../produce/" title="Producing data" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Next</span>Producing data</span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright"><div class="md-footer-copyright__highlight">Copyright (c) 2020 Adevinta</div>powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div></div></div></footer></div><script src="../../assets/javascripts/application.b260a35d.js"></script><script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script></body></html>